<!DOCTYPE html>
<html>
<head>
    <title>Space Shooter - Pixel Edition</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body { margin: 0; overflow: hidden; background: #050510; font-family: Arial; touch-action: manipulation; }
        canvas { display: block; background: radial-gradient(circle, #1b2735 0%, #000 100%); margin: auto; }
        
        /* Kontrol untuk HP */
        .controls { 
            position: absolute; bottom: 20px; width: 100%; display: flex; justify-content: space-around; 
            pointer-events: none; z-index: 10;
        }
        .dpad, .action { pointer-events: auto; display: flex; flex-wrap: wrap; width: 140px; }
        .btn { 
            width: 55px; height: 55px; background: rgba(255,255,255,0.15); 
            border: 2px solid rgba(255,255,255,0.5); border-radius: 12px; color: white; 
            display: flex; justify-content: center; align-items: center; 
            margin: 4px; user-select: none; -webkit-tap-highlight-color: transparent;
            font-size: 20px;
        }
        .btn:active { background: rgba(255,255,255,0.4); border-color: #fff; }
        .fire-btn { width: 90px; height: 90px; border-radius: 50%; background: rgba(255,0,0,0.3); border: 3px solid #ff4444; font-weight: bold; }
    </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>

<div class="controls">
    <div class="dpad">
        <div style="width:100%; display:flex; justify-content:center;">
            <div class="btn" id="btnUp">▲</div>
        </div>
        <div class="btn" id="btnLeft">◀</div>
        <div class="btn" id="btnRight">▶</div>
        <div style="width:100%; display:flex; justify-content:center;">
            <div class="btn" id="btnDown">▼</div>
        </div>
    </div>
    <div class="action">
        <div class="btn fire-btn" id="btnFire">FIRE</div>
    </div>
</div>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    // Setting ukuran layar agar pas di HP/Laptop
    canvas.width = window.innerWidth > 600 ? 500 : window.innerWidth;
    canvas.height = window.innerHeight;

    // --- PENGATURAN GAMBAR ---
    const playerImg = new Image();
    // Nama file harus sama persis dengan yang ada di GitHub kamu
    playerImg.src = 'plane_pixel.png'; 

    let player = { x: canvas.width/2 - 30, y: canvas.height - 180, size: 60, speed: 7 };
    let enemies = [], bullets = [], stars = [], gameOver = false, score = 0;

    // Bintang latar belakang
    for(let i=0; i<60; i++) {
        stars.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, s: Math.random()*2});
    }

    function spawnEnemy() {
        enemies.push({ 
            x: Math.random() * (canvas.width - 40), 
            y: -50, 
            size: 45, 
            speed: 2 + Math.random() * 3 
        });
    }
    spawnEnemy();

    // Kontrol Keyboard
    let keys = {};
    window.addEventListener("keydown", e => { 
        keys[e.code] = true; 
        if(e.code === "Space") fire(); 
    });
    window.addEventListener("keyup", e => keys[e.code] = false);

    // Kontrol Touch/Tombol HP
    const setupBtn = (id, key) => {
        const btn = document.getElementById(id);
        btn.addEventListener("touchstart", (e) => { e.preventDefault(); keys[key] = true; });
        btn.addEventListener("touchend", (e) => { e.preventDefault(); keys[key] = false; });
    };
    setupBtn("btnUp", "ArrowUp");
    setupBtn("btnDown", "ArrowDown");
    setupBtn("btnLeft", "ArrowLeft");
    setupBtn("btnRight", "ArrowRight");
    document.getElementById("btnFire").addEventListener("touchstart", (e) => { e.preventDefault(); fire(); });

    function fire() {
        if(gameOver) return;
        bullets.push({ x: player.x + player.size/2 - 2, y: player.y, speed: 12 });
    }

    function update() {
        if (gameOver) return;

        // Pergerakan
        if (keys["ArrowLeft"] && player.x > 0) player.x -= player.speed;
        if (keys["ArrowRight"] && player.x < canvas.width - player.size) player.x += player.speed;
        if (keys["ArrowUp"] && player.y > 0) player.y -= player.speed;
        if (keys["ArrowDown"] && player.y < canvas.height - 100) player.y += player.speed;

        // Peluru
        bullets.forEach((b, i) => { 
            b.y -= b.speed; 
            if(b.y < 0) bullets.splice(i, 1); 
        });
        
        // Musuh
        enemies.forEach((e, ei) => {
            e.y += e.speed;
            
            // Cek Tabrakan Peluru
            bullets.forEach((b, bi) => {
                if(b.x < e.x + e.size && b.x + 4 > e.x && b.y < e.y + e.size && b.y + 15 > e.y) {
                    enemies.splice(ei, 1); bullets.splice(bi, 1);
                    score += 10; spawnEnemy();
                }
            });

            // Cek Tabrakan Pesawat
            if(player.x + 10 < e.x + e.size - 10 && player.x + player.size - 10 > e.x + 10 && 
               player.y + 10 < e.y + e.size - 10 && player.y + player.size - 10 > e.y + 10) {
                gameOver = true;
            }

            if(e.y > canvas.height) { 
                enemies.splice(ei, 1); 
                spawnEnemy(); 
            }
        });
        if (score > 0 && score % 100 === 0 && enemies.length < 3) spawnEnemy();
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Gambar Bintang
        ctx.fillStyle = "white";
        stars.forEach(s => { 
            ctx.fillRect(s.x, s.y, s.s, s.s); 
            s.y += 1; if(s.y > canvas.height) s.y = 0; 
        });
        
        // Gambar Peluru
        ctx.fillStyle = "#00ffff";
        bullets.forEach(b => ctx.fillRect(b.x, b.y, 4, 15));
        
        // Gambar Meteor/Musuh
        ctx.fillStyle = "#8b4513";
        enemies.forEach(e => { 
            ctx.beginPath(); ctx.arc(e.x + e.size/2, e.y + e.size/2, e.size/2, 0, Math.PI*2); ctx.fill(); 
        });

        // Gambar Pesawat (Menggunakan Gambar Kamu)
        if(!gameOver) {
            ctx.drawImage(playerImg, player.x, player.y, player.size, player.size);
        }

        ctx.fillStyle = "white";
        ctx.font = "bold 20px Arial";
        ctx.fillText("SCORE: " + score, 20, 40);

        if(gameOver) {
            ctx.fillStyle = "rgba(0,0,0,0.8)";
            ctx.fillRect(0,0,canvas.width, canvas.height);
            ctx.fillStyle = "red";
            ctx.textAlign = "center";
            ctx.font = "bold 40px Arial";
            ctx.fillText("GAME OVER", canvas.width/2, canvas.height/2);
            ctx.fillStyle = "white";
            ctx.font = "20px Arial";
            ctx.fillText("Refresh untuk main lagi", canvas.width/2, canvas.height/2 + 50);
            return;
        }
        update();
        requestAnimationFrame(draw);
    }

    // Jalankan game saat gambar sudah siap
    playerImg.onload = () => { draw(); };
    playerImg.onerror = () => { 
        alert("Gambar plane_pixel.png tidak ditemukan di folder GitHub kamu!");
        draw(); // Tetap jalankan meski gambar gagal
    };
</script>
</body>
</html>
